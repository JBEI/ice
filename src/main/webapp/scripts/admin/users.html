<div ng-controller="AdminUserController">
    <div class="pad_top">
        <button type="button" ng-click="showCreateProfile=true" class="ice-button">
            <i style="font-size: 14px" class="blue fa fa-user"></i> Create Account
        </button>
    </div>

    <div class="margin-top-10 panel panel-default font-95em" ng-show="showCreateProfile">
        <form class="panel-body" role="form" ng-submit="createProfile()">
            <div class="col-md-2 pad-top-5 text-right">
                <span style="white-space:nowrap">First name <span class="required">*</span> </span>
            </div>

            <div class="col-md-10 pad-top-5">
                <input type="text" class="input_box" ng-model="newProfile.firstName" maxlength="125"
                       style="width: 235px;">
            </div>
            <div class="col-md-2 pad-top-5 text-right">
                Last name <span class="required">*</span>
            </div>

            <div class="col-md-10 pad-top-5">
                <input type="text" class="input_box" ng-model="newProfile.lastName" maxlength="125"
                       style="width: 235px;">
            </div>

            <div class="col-md-2 pad-top-5 text-right">
                Email <span class="required">*</span>
            </div>

            <div class="col-md-10 pad-top-5">
                <input type="text" ng-model="newProfile.email" class="input_box" maxlength="125" style="width: 235px;">
            </div>

            <div class="col-md-2 pad-top-5 text-right">
                <span style="white-space:nowrap">Institution</span>
            </div>
            <div class="col-md-10 pad-top-5">
                <input type="text" class="input_box" ng-model="newProfile.institution" maxlength="125"
                       style="width: 235px;">
            </div>

            <div class="col-md-2 pad-top-5 text-right">
                <span style="white-space:nowrap">About</span>
            </div>
            <div class="col-md-10 pad-top-5">
                <textarea rows="3" cols="30" ng-model="newProfile.description" class="input_box"
                          placeholder="Enter profile description"></textarea>
            </div>

            <br>

            <div class="col-xs-offset-2 col-md-10 pad_top">
                <button type="submit" class="btn btn-xs btn-primary">Save</button>
                <button type="button" ng-click="showCreateProfile=undefined" class="btn btn-xs btn-default">Cancel
                </button>
            </div>
        </form>
    </div>
    <div class="pad_top">
        <table cellspacing="0" class="table table-hover font-95em" ng-class="{'opacity_4':loadingPage}">
            <thead>
            <tr data-ng-show='!userList'>
                <td colspan="10">Loading...</td>
            </tr>

            <tr data-ng-if='userList && userList.users.length > 0'>
                <th ng-click="sort('type')" style="width: 85px">
                    <span class="cursor_pointer">Name</span>
                </th>
                <th ng-click="sort('summary')">AccountType</th>
                <th ng-click="sort('status')">
                    <span class="cursor_pointer"># Entries</span>
                </th>
                <th ng-click="sort('summary')">Registered</th>
                <th ng-click="sort('summary')">Last Login</th>
            </tr>
            <tr data-ng-show=" userList.users.length == 0">
                <td colspan="10">No user accounts available</td>
            </tr>
            </thead>
            <tbody>
            <tr data-ng-repeat="userItem in userList.users">
                <td class="no_wrap">{{userItem.firstName}} {{userItem.lastName}} (<a ng-href="profile/{{userItem.id}}">{{userItem.email}}</a>)
                </td>
                <td style="width:160px; white-space:nowrap">
                    <!-- Single button -->
                    <div class="btn-group" dropdown>
                        <button type="button" class="btn btn-xs dropdown-toggle" dropdown-toggle
                                ng-class="{'btn-warning':userItem.isAdmin, 'btn-default':!userItem.isAdmin}">
                            {{userItem.accountType |capitalize}} <span class="caret"></span>
                        </button>
                        <ul class="dropdown-menu">
                            <li ng-if="userItem.accountType != 'ADMIN'"
                                ng-click="setUserAccountType(userItem, 'ADMIN')"><a href="#">Admin</a></li>
                            <li ng-if="userItem.accountType != 'NORMAL'"
                                ng-click="setUserAccountType(userItem, 'NORMAL')"><a href="#">Regular</a></li>
                        </ul>
                    </div>
                </td>
                <td style="width:90px; white-space:nowrap">{{userItem.userEntryCount | number}}</td>
                <td style="width:160px; white-space:nowrap">{{userItem.registerDate | date:'MMM d, yyyy'}}</td>
                <td style="width:160px; white-space:nowrap"><span ng-show="userItem.lastLogin">{{userItem.lastLogin | date:'MMM d, yyyy'}}</span>
                </td>
            </tr>
            </tbody>
        </table>
    </div>

    <div ng-if="userList && userList.users.length > 0">
        <div class="col-md-5" style="padding-left: 0">
            <pagination total-items="userList.resultCount" ng-change="userListPageChanged()"
                        ng-model="userListParams.currentPage"
                        max-size="maxSize" class="pagination-sm" items-per-page="15" boundary-links="true"></pagination>
        </div>

        <div class="col-md-7" style="margin-top: 25px;">
            <strong class="small">
                <i ng-show="loadingPage" class="fa fa-spin fa-gear opacity_4"></i>
                {{pageCounts(userListParams.currentPage,
                userList.resultCount)}}
            </strong>
        </div>

    </div>
</div>